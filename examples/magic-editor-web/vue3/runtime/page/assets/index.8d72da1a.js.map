{"version":3,"file":"index.8d72da1a.js","sources":["../../../../../../packages/ui/src/cpie/src/index.vue"],"sourcesContent":["<template>\n  <div class=\"t-inline-block magic-ui-echart-module\" ref=\"refCpie\" :style=\"style\" />\n</template>\n\n<script lang=\"ts\" setup>\nimport { onMounted, Ref, ref, shallowRef, watch } from 'vue';\nimport * as echarts from 'echarts';\n\nimport { legendInitOption } from '../../commonConfig';\nimport { MCPie } from '../../types';\nimport useApp from '../../useApp';\nimport useEcharts from '../../useEcharts';\nimport useStyle from '../../useStyle';\nimport { setCenterRadiusData, setLegendOption, shouldUpdateCreator } from '../../util';\n\nconst props = defineProps<{\n  config: MCPie;\n  // model: Object;\n}>();\n\nuseApp(props);\n\nconst refCpie = ref<HTMLElement | null>(null);\nconst refCharts = shallowRef<any>();\n\nconst getChartData = () => {\n  const { dataList, colors } = props.config.dataSourceModel;\n  const { showLabel, centerX, centerY, itemBorderWidth, itemBorderColor, itemBorderRadius, innerRadius, outerRadius } =\n    props.config;\n  const seriesDataItem: any = {\n    type: 'pie',\n    ...setCenterRadiusData({ centerX, centerY, innerRadius, outerRadius }),\n    data: dataList?.map((item, index) => {\n      const [name, value] = item;\n      const itemData: any = {\n        name,\n        value,\n      };\n      const color = colors![index];\n      if (color) {\n        itemData.itemStyle = {\n          color,\n        };\n      }\n      return itemData;\n    }),\n    label: {\n      show: showLabel,\n    },\n    labelLine: {\n      show: showLabel,\n    },\n    itemStyle: {\n      borderRadius: itemBorderRadius || 0,\n      borderColor: itemBorderColor,\n      borderWidth: itemBorderWidth || 0,\n    },\n  };\n  const seriesData = [seriesDataItem];\n  return {\n    series: seriesData,\n  };\n};\nconst setChartData = (option: any, getChartData: Function) => {\n  const data = getChartData();\n  option.series = data.series;\n};\n\nonMounted(() => {\n  const { config } = props;\n  const option: echarts.EChartsOption = {\n    legend: [legendInitOption(config)],\n    tooltip: [\n      {\n        show: config.tooltip,\n        trigger: 'item',\n      },\n    ],\n    series: [],\n  };\n  refCharts.value = useEcharts(option, refCpie as Ref<HTMLElement>).value;\n\n  watch(\n    () => props.config,\n    (newVal, oldVal: any = {}) => {\n      const option = refCharts.value?.getOption();\n      const shouldUpdate = shouldUpdateCreator(newVal, oldVal);\n      setLegendOption(shouldUpdate, option, newVal);\n      if (shouldUpdate('tooltip')) {\n        option.tooltip[0].show = newVal.tooltip;\n      }\n\n      setChartData(option, getChartData);\n      refCharts.value.setOption(option);\n    },\n    {\n      immediate: true,\n    },\n  );\n});\n\nconst style = useStyle(props, refCharts);\n</script>\n<style lang=\"scss\" scoped>\n.t-inline-block {\n  display: inline-block;\n}\n</style>\n"],"names":["useApp","props","refCpie","refCharts","getChartData","dataList","colors","showLabel","centerX","centerY","itemBorderWidth","itemBorderColor","itemBorderRadius","innerRadius","outerRadius","setCenterRadiusData","item","index","name","value","itemData","color","setChartData","option","getChartData2","data","config","legendInitOption","useEcharts","newVal","oldVal","option2","_a","shouldUpdate","shouldUpdateCreator","setLegendOption","style","useStyle"],"mappings":"6UAoBAA,EAAAC,CAAA,EAEA,MAAAC,EAAgB,cAChBC,EAAkB,IAAgB,aAElCC,EAAA,IAAA,CACE,KAAA,CAAA,SAAAC,EAAA,OAAAC,CAAA,EAAAL,EAAA,OAAA,gBACA,CAAA,UAAAM,EAAA,QAAAC,EAAA,QAAAC,EAAA,gBAAAC,EAAA,gBAAAC,EAAA,iBAAAC,EAAA,YAAAC,EAAA,YAAAC,GAAAb,EAAA,OAgCA,MAAA,CAAO,OADP,CA7BA,CAA4B,KAAA,MACpB,GAAAc,EAAA,CAAA,QAAAP,EAAA,QAAAC,EAAA,YAAAI,EAAA,YAAAC,CAAA,CAAA,EAC+D,KAAAT,GAAA,YAAAA,EAAA,IAAA,CAAAW,EAAAC,IAAA,CAEnE,KAAA,CAAAC,EAAAC,CAAA,EAAAH,EACAI,EAAA,CAAsB,KAAAF,EACpB,MAAAC,CACA,EAEFE,EAAAf,EAAAW,GACA,OAAAI,IACED,EAAA,UAAA,CAAqB,MAAAC,CACnB,GAGJD,CAAO,GACR,MAAA,CACM,KAAAb,CACC,EACR,UAAA,CACW,KAAAA,CACH,EACR,UAAA,CACW,aAAAK,GAAA,EACyB,YAAAD,EACrB,YAAAD,GAAA,CACmB,CAClC,CAEF,CAEU,CACV,EAEFY,EAAA,CAAAC,EAAAC,IAAA,CACE,MAAAC,EAAAD,IACAD,EAAA,OAAAE,EAAA,MAAqB,EAGvB,IAAA,UAAA,IAAA,CACE,KAAA,CAAA,OAAAC,CAAA,EAAAzB,EACAsB,EAAA,CAAsC,OAAA,CAAAI,EAAAD,CAAA,CAAA,EACH,QAAA,CACxB,CACP,KAAAA,EAAA,QACe,QAAA,MACJ,CACX,EACF,OAAA,CAAA,CACS,EAEXvB,EAAA,MAAAyB,EAAAL,EAAArB,CAAA,EAAA,MAEA,IAAA,MAAA,IAAAD,EAAA,OACc,CAAA4B,EAAAC,EAAA,KAAA,OAEV,MAAAC,GAAAC,EAAA7B,EAAA,QAAA,YAAA6B,EAAA,YACAC,EAAAC,EAAAL,EAAAC,CAAA,EACAK,EAAAF,EAAAF,EAAAF,CAAA,EACAI,EAAA,SAAA,IACEF,EAAA,QAAA,GAAA,KAAAF,EAAA,SAGFP,EAAAS,EAAA3B,CAAA,EACAD,EAAA,MAAA,UAAA4B,CAAA,CAAgC,EAClC,CACA,UAAA,EACa,CACb,CACF,CAAA,EAGF,MAAAK,EAAAC,EAAApC,EAAAE,CAAA"}