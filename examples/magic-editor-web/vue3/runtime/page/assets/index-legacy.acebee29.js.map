{"version":3,"file":"index-legacy.acebee29.js","sources":["../../../../../../packages/ui/src/cpie/src/index.vue"],"sourcesContent":["<template>\n  <div class=\"t-inline-block magic-ui-echart-module\" ref=\"refCpie\" :style=\"style\" />\n</template>\n\n<script lang=\"ts\" setup>\nimport { onMounted, Ref, ref, shallowRef, watch } from 'vue';\nimport * as echarts from 'echarts';\n\nimport { legendInitOption } from '../../commonConfig';\nimport { MCPie } from '../../types';\nimport useApp from '../../useApp';\nimport useEcharts from '../../useEcharts';\nimport useStyle from '../../useStyle';\nimport { setCenterRadiusData, setLegendOption, shouldUpdateCreator } from '../../util';\n\nconst props = defineProps<{\n  config: MCPie;\n  // model: Object;\n}>();\n\nuseApp(props);\n\nconst refCpie = ref<HTMLElement | null>(null);\nconst refCharts = shallowRef<any>();\n\nconst getChartData = () => {\n  const { dataList, colors } = props.config.dataSourceModel;\n  const { showLabel, centerX, centerY, itemBorderWidth, itemBorderColor, itemBorderRadius, innerRadius, outerRadius } =\n    props.config;\n  const seriesDataItem: any = {\n    type: 'pie',\n    ...setCenterRadiusData({ centerX, centerY, innerRadius, outerRadius }),\n    data: dataList?.map((item, index) => {\n      const [name, value] = item;\n      const itemData: any = {\n        name,\n        value,\n      };\n      const color = colors![index];\n      if (color) {\n        itemData.itemStyle = {\n          color,\n        };\n      }\n      return itemData;\n    }),\n    label: {\n      show: showLabel,\n    },\n    labelLine: {\n      show: showLabel,\n    },\n    itemStyle: {\n      borderRadius: itemBorderRadius || 0,\n      borderColor: itemBorderColor,\n      borderWidth: itemBorderWidth || 0,\n    },\n  };\n  const seriesData = [seriesDataItem];\n  return {\n    series: seriesData,\n  };\n};\nconst setChartData = (option: any, getChartData: Function) => {\n  const data = getChartData();\n  option.series = data.series;\n};\n\nonMounted(() => {\n  const { config } = props;\n  const option: echarts.EChartsOption = {\n    legend: [legendInitOption(config)],\n    tooltip: [\n      {\n        show: config.tooltip,\n        trigger: 'item',\n      },\n    ],\n    series: [],\n  };\n  refCharts.value = useEcharts(option, refCpie as Ref<HTMLElement>).value;\n\n  watch(\n    () => props.config,\n    (newVal, oldVal: any = {}) => {\n      const option = refCharts.value?.getOption();\n      const shouldUpdate = shouldUpdateCreator(newVal, oldVal);\n      setLegendOption(shouldUpdate, option, newVal);\n      if (shouldUpdate('tooltip')) {\n        option.tooltip[0].show = newVal.tooltip;\n      }\n\n      setChartData(option, getChartData);\n      refCharts.value.setOption(option);\n    },\n    {\n      immediate: true,\n    },\n  );\n});\n\nconst style = useStyle(props, refCharts);\n</script>\n<style lang=\"scss\" scoped>\n.t-inline-block {\n  display: inline-block;\n}\n</style>\n"],"names":["useApp","props","refCpie","Vue","refCharts","shallowRef","getChartData","dataList","colors","config","dataSourceModel","showLabel","centerX","centerY","itemBorderWidth","itemBorderColor","itemBorderRadius","innerRadius","outerRadius","seriesDataItem","type","setCenterRadiusData","data","map","item","index","name","value","itemData","color","itemStyle","label","show","labelLine","borderRadius","borderColor","borderWidth","series","onMounted","option","legend","legendInitOption","tooltip","trigger","useEcharts","watch","newVal","oldVal","option2","getOption","shouldUpdate","shouldUpdateCreator","setLegendOption","setChartData","getChartData2","setOption","immediate","style","useStyle"],"mappings":"yjBAoBAA,EAAAC,GAEA,MAAAC,EAAgBC,cAChBC,EAAkBD,IAAgBE,aAElCC,EAAAA,KACE,MAAAC,SAAAA,EAAAC,OAAAA,GAAAP,EAAAQ,OAAAC,iBACAC,UAAAA,EAAAC,QAAAA,EAAAC,QAAAA,EAAAC,gBAAAA,EAAAC,gBAAAA,EAAAC,iBAAAA,EAAAC,YAAAA,EAAAC,YAAAA,GAAAjB,EAAAQ,OAEAU,EAAA,CAA4BC,KAAA,SACpBC,EAAA,CAAAT,UAAAC,UAAAI,cAAAC,gBAC+DI,KAAAf,GAAAgB,KAAA,CAAAC,EAAAC,KAEnE,MAAAC,EAAAC,GAAAH,EACAI,EAAA,CAAsBF,OACpBC,SAGFE,EAAArB,EAAAiB,GAMA,OALAI,IACED,EAAAE,UAAA,CAAqBD,UAIvBD,CAAA,IACDG,MAAA,CACMC,KAAArB,GAEPsB,UAAA,CACWD,KAAArB,GAEXmB,UAAA,CACWI,aAAAlB,GAAA,EACyBmB,YAAApB,EACrBqB,YAAAtB,GAAA,IAKjB,MAAA,CAAOuB,OADP,CAAAlB,GAEU,EAQZhB,IAAAmC,WAAA,KACE,MAAA7B,OAAAA,GAAAR,EACAsC,EAAA,CAAsCC,OAAA,CAAAC,EAAAhC,IACHiC,QAAA,CACxB,CACPV,KAAAvB,EAAAiC,QACeC,QAAA,SAGjBN,OAAA,IAGFjC,EAAAuB,MAAAiB,EAAAL,EAAArC,GAAAyB,MAEAxB,IAAA0C,OAAA,IAAA5C,EAAAQ,SACc,CAAAqC,EAAAC,EAAA,MAEV,MAAAC,EAAA5C,EAAAuB,OAAAsB,YACAC,EAAAC,EAAAL,EAAAC,GACAK,EAAAF,EAAAF,EAAAF,GACAI,EAAA,aACEF,EAAAN,QAAA,GAAAV,KAAAc,EAAAJ,SA1BRW,EAAAd,EAAAe,KACE,MAAAhC,EAAAgC,IACAf,EAAAF,OAAAf,EAAAe,MAAA,EA2BIgB,CAAAL,EAAA1C,GACAF,EAAAuB,MAAA4B,UAAAP,EAAA,GACF,CACAQ,WAAA,GAEA,IAIJ,MAAAC,EAAAC,EAAAzD,EAAAG"}